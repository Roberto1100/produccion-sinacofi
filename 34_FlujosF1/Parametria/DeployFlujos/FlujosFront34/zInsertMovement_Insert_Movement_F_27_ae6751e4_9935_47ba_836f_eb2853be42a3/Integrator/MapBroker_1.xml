<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<MapBrokers xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="MapBrokers_2.xsd">
   <MapBroker dmlCompatibility="2.1" id="e032af9f-815a-45ae-b41b-4cb076743e0e" label="" lastModified="2024-04-25T15:31:44.000Z" name="MAPSERVICE_InsertMovement_Insert_Movement_Flow::MAPSERVICE.InsertMovement.Main_Block_Insert_Movement_Flow1" xmlVersion="1.0">
      <DmlMapBroker>
         <InputBusinessDocuments>
            <InputBusinessDocument>
               <BusinessDocument id="2fda2dca-560f-4157-817f-52b4a8ce9afe">
                  <name>MAPSERVICE_InsertMovement_Insert_Movement_Flow::MAPSERVICE.InsertMovement.Movement</name>
                  <lastModified>2024-06-04T16:30:32.000Z</lastModified>
               </BusinessDocument>
               <Alias>in1</Alias>
            </InputBusinessDocument>
         </InputBusinessDocuments>
         <DecisionPath>
            <StepStep>
               <DmlExpression><![CDATA[%Correlativo:= getSubString(getAttribute( "B2BXGIReceive_ConsumptionFilename" ), 5, 8 );
%CodEstado:=getSubString(getAttribute( "B2BXGIReceive_ConsumptionFilename" ), 14, 2 );
%Movimiento:=InsertMovTBL(%Correlativo, null , null, null, %CodEstado, formatString(getDateAndTime(), "CCYY'-'MM'-'DD hh':'mm':'ss"))]]></DmlExpression>
            </StepStep>
            <StepIf>
               <DmlExpression><![CDATA[%CodEstado = "60" and GetFlujoByCorrelativo( %Correlativo ) = "MFT"]]></DmlExpression>
               <StepMappingRule>
                  <MappingRule id="d2631074-70b5-4874-bad3-ce7d93ac37a6" label="" lastModified="2024-06-04T16:30:32.000Z" name="MAPSERVICE_InsertMovement_Insert_Movement_Flow::MAPSERVICE.InsertMovement.CrearNotificacion:CrearNotificacion" xmlVersion="1.0">
                     <OutputBusinessDocument id="a91daccd-1073-4c31-9ac1-880c96b27f33">
                        <name>MAPSERVICE_InsertMovement_Insert_Movement_Flow::MAPSERVICE.InsertMovement.Notificacion</name>
                        <lastModified>2024-06-04T16:30:32.000Z</lastModified>
                     </OutputBusinessDocument>
                     <MappingElement ElementReferenceId="2">
                        <Expression>
                           <DmlExpression><![CDATA["MENSAJE_RESULTADO"]]></DmlExpression>
                        </Expression>
                        <Comment/>
                     </MappingElement>
                     <MappingElement ElementReferenceId="6">
                        <Expression>
                           <DmlExpression><![CDATA["FIN_MENSAJE"]]></DmlExpression>
                        </Expression>
                        <Comment/>
                     </MappingElement>
                     <MappingElement ElementReferenceId="4">
                        <Expression>
                           <DmlExpression><![CDATA[%Correlativo:= getSubString(getAttribute( "B2BXGIReceive_ConsumptionFilename" ), 5, 8 );
padStringRight( GetNombreArchivoByCorrelativo( %Correlativo ), 20, " " )&padStringRight( GetCasillaDestinoByCorrelativo( %Correlativo ), 20, " " )]]></DmlExpression>
                        </Expression>
                        <Comment/>
                     </MappingElement>
                  </MappingRule>
                  <StepOutput>
                     <OutputName>out</OutputName>
                  </StepOutput>
               </StepMappingRule>
               <StepStep>
                  <DmlExpression><![CDATA[%NombreArchivo:=GetNombreArchivoByCorrelativo( %Correlativo );
%Casilla:=GetCasillaOrigenByCorrelativo( %Correlativo );
setDocumentAttributeToOutput( "out",  "B2BXGISend_ProductionFilename", %Casilla &"_"& %NombreArchivo&".NOT")
]]></DmlExpression>
               </StepStep>
            </StepIf>
            <StepExit/>
         </DecisionPath>
      </DmlMapBroker>
   </MapBroker>
</MapBrokers>
