<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<MapBrokers xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="MapBrokers_2.xsd">
   <MapBroker dmlCompatibility="2.1" id="cf0945b0-28c2-4639-a6c9-bddbb3e71ab9" label="" lastModified="2024-07-09T00:10:55.000Z" name="MAPSERVICE_Sinacofi_C18_F1_C18_FRONT::MAPSERVICE.Sinacofi_C18_F1.Calcular_Cam" xmlVersion="1.0">
      <DmlMapBroker>
         <InputBusinessDocuments>
            <InputBusinessDocument>
               <BusinessDocument id="5a26c413-5426-4534-8607-9d23965d6be1">
                  <name>MAPSERVICE_Sinacofi_C18_F1_C18_FRONT::MAPSERVICE.Sinacofi_C18_F1\ArchivosEntrada.C18_Archivo_Datos</name>
                  <lastModified>2024-08-12T14:32:46.000Z</lastModified>
               </BusinessDocument>
               <Alias>in</Alias>
            </InputBusinessDocument>
         </InputBusinessDocuments>
         <DecisionPath>
            <StepMappingRule>
               <MappingRule id="1cb16b97-c668-4742-bf9c-e7da78efdc15" label="" lastModified="2024-08-12T14:32:46.000Z" name="MAPSERVICE_Sinacofi_C18_F1_C18_FRONT::MAPSERVICE.Sinacofi_C18_F1.Calcular_Campos:Calcular_Campos" xmlVersion="1.0">
                  <OutputBusinessDocument id="29b6fc93-a3f5-4ed1-bd2a-a3828141c0b1">
                     <name>MAPSERVICE_Sinacofi_C18_F1_C18_FRONT::MAPSERVICE.Sinacofi_C18_F1\Salida.C18_Caratula_Salida</name>
                     <lastModified>2024-08-12T14:32:46.000Z</lastModified>
                  </OutputBusinessDocument>
                  <MappingElement ElementReferenceId="3">
                     <Expression>
                        <DmlExpression><![CDATA[count( \Details )
]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="4">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCED:=0;
%totalCEE:=0;
%totalCEF:=0;
%totalCEG:=0;
%totalCEH:=0;
%totalCEI:=0;
%totalCEK:=0;
loop on \Details {
	if ( getSubString( this\Contenido, 21, 1 ) = "1" ) then {
		%totalCED:=%totalCED + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 ))
    	};
  	if ( getSubString( this\Contenido, 21, 1 ) = "2" ) then {
			%totalCEE:=%totalCEE + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 ))
  	   };
  	if ( getSubString( this\Contenido, 21, 1 ) = "3" ) then {
			%totalCEF:=%totalCEF + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 ))
  	  };
  	 if ( getSubString( this\Contenido, 22, 1 ) = "1" ) then {
			%totalCEG:=%totalCEG + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 ))
  	  };  	
  	  if ( getSubString( this\Contenido, 22, 1 ) = "2" ) then {
			%totalCEH:=%totalCEH + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 )) 	 
	 };
  	   if ( getSubString( this\Contenido, 22, 1 ) = "3" ) then {
			%totalCEI:=%totalCEI + convertToI( getSubString( this\Contenido, 23, 14 ))+ convertToI( getSubString( this\Contenido, 37, 14 ))+ convertToI( getSubString( this\Contenido, 51, 14 ))+ convertToI( getSubString( this\Contenido, 65, 14 ))+ convertToI( getSubString( this\Contenido, 79, 14 ))+ convertToI( getSubString( this\Contenido, 93, 14 ))+ convertToI( getSubString( this\Contenido, 107, 14 ))
  	  };
  	  %totalCEK:=%totalCEK +convertToI( getSubString( this\Contenido, 121, 14 ))
  };
%totalCED]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="6">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEF]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="7">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEG]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="5">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEE]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="2">
                     <Expression>
                        <DmlExpression><![CDATA[getSubString( in:\Header\Datos,8,6 )]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="8">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEH]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="9">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEI]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
                  <MappingElement ElementReferenceId="10">
                     <Expression>
                        <DmlExpression><![CDATA[%totalCEK]]></DmlExpression>
                     </Expression>
                     <Comment/>
                  </MappingElement>
               </MappingRule>
               <StepOutput>
                  <OutputName>out</OutputName>
               </StepOutput>
            </StepMappingRule>
            <StepOutput>
               <OutputName>out1</OutputName>
               <InputBusinessDocumentAlias>in</InputBusinessDocumentAlias>
            </StepOutput>
            <StepOutput>
               <OutputName>out2</OutputName>
               <InputBusinessDocumentAlias>in</InputBusinessDocumentAlias>
            </StepOutput>
            <StepStep>
               <DmlExpression><![CDATA[%correlativoPrefijo:= getSubString(getAttribute( "B2BXGIReceive_ConsumptionFilename" ), 5, 8 );
setDocumentAttributeToOutput( "out1",  "B2BXGISend_ProductionFilename",%correlativoPrefijo &"_datosSalida");
setDocumentAttributeToOutput( "out2",  "B2BXGISend_ProductionFilename",getSubString(getAttribute("B2BXGIReceive_ConsumptionFilename" ), 5, 255) + getAttribute( "B2BXGIReceive_ConsumptionExtension"))]]></DmlExpression>
            </StepStep>
         </DecisionPath>
      </DmlMapBroker>
   </MapBroker>
</MapBrokers>
